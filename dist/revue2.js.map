{"version":3,"file":"revue2.js","sources":["../src/utils.js","../src/extend.js","../src/index.js"],"sourcesContent":["export function shallowEqual(objA, objB) {\n  if (objA === objB) return true;\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) return false;\n\n  // Test for A's keys different from B.\n  const hasOwn = Object.prototype.hasOwnProperty;\n  for (let i = 0; i < keysA.length; i++) {\n    if (!hasOwn.call(objB, keysA[i]) ||\n      objA[keysA[i]] !== objB[keysA[i]]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { shallowEqual } from './utils';\n\n/**\n * Extend Vue prototype + global mixin\n *\n * @param {Vue} Vue\n */\n\nexport function extendVue(Vue) {\n  Vue.prototype.$connect = function(mapState) {\n    const vm = this;\n    const getMappedState = (state = this.$store.state) => mapState(state);\n\n    const observeStore = (store, currState, select, onChange) => {\n      if (typeof onChange !== 'function') return null;\n      let currentState = currState || {};\n\n      function handleChange() {\n        const nextState = getMappedState();\n        if (!shallowEqual(currentState, nextState)) {\n          const previousState = currentState;\n          currentState = nextState;\n          onChange(currentState, previousState);\n        }\n      }\n\n      const unsubscribe = store.subscribe(handleChange);\n      handleChange();\n      return unsubscribe\n    }\n\n    observeStore(this.$store, this.$store.state, getMappedState(), (newState, oldState) => {\n      Object.keys(newState).forEach(key => {\n        vm[key] = newState[key];\n      });\n    });\n  }\n\n  Object.defineProperty(Vue.prototype, '$store', {\n    get: function $store() {\n      if (!this.$root.store) {\n        throw new Error('No store provided to root component')\n      }\n      return this.$root.store\n    }\n  })\n}\n","import { extendVue } from './extend'\n\nconst isDev = process.env.NODE_ENV !== 'production'\n\nconst RevueInstaller = {\n  install(_Vue) {\n    extendVue(_Vue)\n  }\n}\n\nexport default class Revue {\n  constructor(reduxStore, reduxActions, options) {\n    if (!options.component) {\n      throw new Error('You must provide an entry point component to Revue')\n    }\n\n\t\tif (typeof window !== 'undefined' && window.Vue) {\n\t\t\tconst Vue = window.Vue;\n\t\t\tVue.use(RevueInstaller)\n\t\t} else {\n\t\t\tthrow new Error('Please load Vue before instanciating Revue');\n\t\t}\n    // Apply global mixin and extend prototype\n\n    this.store = reduxStore\n    this.subscribe = this.subscribe.bind(this);\n    if (reduxActions) {\n      this.reduxActions = reduxActions\n    }\n\n    const revueInstance = this;\n\n    this.Provider = {\n      render: h => h(options.component),\n      data: function() {\n        return Object.assign({}, {\n          store: revueInstance\n        }, options.data)\n      }\n    };\n  }\n  subscribe(cb) {\n    this.store.subscribe(cb)\n  }\n  get state() {\n    return this.store.getState()\n  }\n  get actions() {\n    if (isDev && !this.reduxActions) {\n      throw new Error('[Revue] Binding actions to Revue before calling them!')\n    }\n    return this.reduxActions\n  }\n  dispatch(...args) {\n    return this.store.dispatch(...args)\n  }\n}\n"],"names":[],"mappings":"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"}
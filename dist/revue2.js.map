{"version":3,"file":"revue2.js","sources":["../src/utils.js","../src/extend.js","../src/index.js"],"sourcesContent":["import { bindActionCreators } from 'redux'\nconst hasOwn = Object.prototype.hasOwnProperty\n\nfunction is(x, y) {\n  if (x === y) {\n    return x !== 0 || y !== 0 || 1 / x === 1 / y\n  } else {\n    return x !== x && y !== y\n  }\n}\n\nexport function shallowEqual(objA, objB) {\n  if (is(objA, objB)) return true\n\n  if (typeof objA !== 'object' || objA === null ||\n    typeof objB !== 'object' || objB === null) {\n    return false\n  }\n\n  const keysA = Object.keys(objA)\n  const keysB = Object.keys(objB)\n\n  if (keysA.length !== keysB.length) return false\n\n  for (let i = 0; i < keysA.length; i++) {\n    if (!hasOwn.call(objB, keysA[i]) ||\n      !is(objA[keysA[i]], objB[keysA[i]])) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport const wrapActionCreators = (actionCreators) =>\n  dispatch => bindActionCreators(actionCreators, dispatch)\n","import {\n  shallowEqual,\n  wrapActionCreators\n} from './utils'\n\n/**\n * Extend Vue prototype + global mixin\n *\n * @param {Vue} Vue\n */\n\nexport function extendVue(Vue) {\n  Vue.mixin({\n    beforeDestroy() {\n      if (this._unsubscribe) {\n        this._unsubscribe()\n      }\n    }\n  })\n  const defaultMapState = () => ({});\n  const defaultMapDispatch =  dispatch => ({ dispatch });\n\n  Vue.prototype.$connect = function(mapState = defaultMapState, mapDispatch = defaultMapDispatch) {\n    const vm = this\n    const getMappedState = (state = this.$store.state) => mapState(state)\n\n    const actions = wrapActionCreators(mapDispatch)(this.$store.dispatch)\n    Object.keys(actions).forEach(key => {\n      vm[key] = actions[key]\n    })\n\n    const observeStore = (store, currState, select, onChange) => {\n      if (typeof onChange !== 'function') return null\n      let currentState = currState || {}\n\n      function handleChange() {\n        const nextState = select(store.state)\n        if (!shallowEqual(currentState, nextState)) {\n          const previousState = currentState\n          currentState = nextState\n          onChange(currentState, previousState)\n        }\n      }\n\n      onChange(currentState, null) // trigger onChange on component created\n      return store.subscribe(handleChange)\n    }\n\n    this._unsubscribe = observeStore(this.$store, getMappedState(), getMappedState, (newState, oldState) => {\n      Object.keys(newState).forEach(key => {\n        if(vm[key] === undefined) {\n          console.warn(`[revue2] - you forgot to declare property **${key}** in your component's data function making it unreactive`)\n        }\n\n        vm.$set(vm, key, newState[key])\n      })\n    })\n  }\n\n  Object.defineProperty(Vue.prototype, '$store', {\n    get: function $store() {\n      if (!this.$root.store) {\n        throw new Error('[revue2] - No store provided to root component')\n      }\n      return this.$root.store\n    }\n  })\n}\n","import { extendVue } from './extend'\n\nconst isDev = process.env.NODE_ENV !== 'production'\n\nexport default class Revue {\n  constructor(reduxStore) {\n    this.store = reduxStore\n    this.subscribe = this.subscribe.bind(this)\n  }\n  subscribe(cb) {\n    this.store.subscribe(cb)\n  }\n\tget dispatch() {\n\t\treturn this.store.dispatch\n\t}\n  get state() {\n    return this.store.getState()\n  }\n}\n\nRevue.install = (_Vue) =>\t{ extendVue(_Vue) }\n\nif (typeof window !== 'undefined' && window.Vue) {\n\twindow.Vue.use(RevueInstaller)\n}\n"],"names":["bindActionCreators"],"mappings":"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"}